# 口座開設予測の要素整理

## 構造理解
1. 目的変数
    - y：定額預金申し込み有無（1:有り, 0:無し）
1. 顧客の潜在的な口座開設意欲（静的要因）
    → 口座を持ちたい/持てる属性
    - 年齢・ライフステージ
        - age：年齢
        - marital：未婚/既婚
        - education：教育水準
    - 経済的余力・信用
        - balance：年間平均残高（€）
        - default：債務不履行があるか（yes, no）
        - housing：住宅ローン（yes, no）
        - loan：個人ローン（yes, no）
    - 職業による安定性
        - job：職種

1. マーケティング接触の質（動的要因）
    → その人が今回の接触で動いたか
    - 接触チャネル
        - contact：連絡方法
    - 接触時間
        - duration：最終接触時間（秒）
    - 接触回数
        - campaign：現キャンペーンにおける接触回数
1. 過去のキャンペーンの履歴・学習効果
    → 学習済みか、疲弊しているか
    - 過去接触有無
        - previous：接触実績：現キャンペーン以前までに顧客に接触した回数
    - 前回の結果
        - poutcome：前回のキャンペーンの成果
    - 前回からの経過日数
        - pdays：経過日数：前キャンペーン接触後の日数
1. タイミング要因（季節性）
    - month：最終接触月
    - day：最終接触日

## 前処理・FE
1. 型・欠損・異常値の整理
    - カテゴリ変数
    - 歪んだ分布の正規化
1. フラグ化
1. 交互作用

## モデルの状況
### ベースライン
- パブリックスコアのAUC：0.9315817532945465
- oof/hoのAUC：
- 特徴量重要度
    |特徴量|重要度|重要度の標準偏差|
    |:-|:-|:-|
    duration_log|67141.43765086532|12380.803617590758
    poutcome|25392.947609996794|3340.116317405239
    housing|7044.549526312947|1318.5573961145953
    contact_unknown_x_new_flg|6493.087329429388|1319.2935032718642
    month|6414.55100530386,1497|967243188649
    age|5023.34930255413,1092|1956336761868
    pdays|4518.103005287051|1057.4514336396664
    balance_clip|3868.6135636925696|1032.2201963273887
    contact_unknown_x_campaign_clip|2772.6743444234135|632.133458082847
    month_3_x_campaign_clip|2470.6848015069963|445.5506470930835
- 予測ができていないデータの特徴
    - y=1, pred=0
        - is_hard_customer = 1 だが成約
            - is_hard_customerを2段階に分ける
        - poutcome が悪いが duration が極端に長い
            - duration_log × campaign_clip
            - duration_log × is_hard_customer
        - month 的に不利な月での成約
            - month × duration_log
            - month × poutcome
    - y=0, pred=1
        - duration が長いが結局 NG
            - duration_log × poutcome
            - duration_log × contact_unknown
        - 既存客・非硬化だが断られた（難しい部分）

### モデルブレンド・スタッキンg
- 1. 特徴量追加後
- 2. lgb_baseとlgb_without_durationのhpo後のブレンド
- 3. lgb_baseとlgb_without_duration、cat_with_rowcatのhpo後のブレンド
- 4. 4のスタッキング